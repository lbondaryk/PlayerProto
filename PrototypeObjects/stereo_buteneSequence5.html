<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="Author" content="Leslie Bondaryk" />
	<meta name="Owner" content="Pearson" />
	<meta name="Copyright" content="Copyright (c) 2013 Pearson. All rights reserved." />
	<meta content="width=device-width, initial-scale=1.0" name="viewport" />
	<meta content="eCourses Author, Title" name="description" />

    <!-- Bootstrap -->
    <link href="../css/bootstrap_plus.css" rel="stylesheet">
	<link href="../css/widgets.css" rel="stylesheet">
</head>

<body>
	<div id="bricTarget"></div>

	<script src="../js/jquery-latest.js"></script>
	<script src="../js/d3.v3.min.js"></script>

   	<script src="../js/widget-base.js"></script>
	<script src="../js/widget-button.js"></script>
	<script src="../js/widget-sketch.js"></script>
	<script src="../js/widget-labelgroup.js"></script>
	<script src="../js/eventmanager_ex.js"></script>

	<script>
var eventManager = new EventManager();

///////////////////////////////////////////

var svg9 = new SVGContainer({
		node: d3.select("#bricTarget"),
		maxWid: 400,
		maxHt: 200
	});

// molecule 1
var sketch9_1 = new Sketch ({
		id: "sketch9_1",
		drawShape:
		[
			{ shape: "line", data: [{ xyPos: [.5, .5], length: .2, angle: 7*Math.PI/6 }]},
			{ shape: "line", data: [{ xyPos: [.5, .5], length: .2, angle: -Math.PI/6 }]},
			{ shape: "line", data: [{ xyPos: [.32, .4], length: .2, angle: 5*Math.PI/6 }]},
			{ shape: "line", data: [{ xyPos: [.14, .5], length: .2, angle: 7*Math.PI/6 }]},
			{ shape: "line", data: [{ xyPos: [.68, .4], length: .15, angle: Math.PI/6 }]},
			{ shape: "textBit", data: [{ xyPos: [.85, .47], text: "Cl" }]},
			
			// label is part of molecule, since the molecule doesn't move
			{ shape: "textBit", data: [{ xyPos: [.05, .85], text: "a." }]},
		]
	});
	
// this part of molecule 1 moves separately
var sketch9_2 = new Sketch ({
		id: "sketch9_2",
		drawShape:
		[
			{ shape: "line", data: [{ xyPos: [.5, .5], length: .2, angle: Math.PI/2 }]},
			{ shape: "line", data: [{ xyPos: [.53, .515], length: .17, angle: Math.PI/2 }]},
			{ shape: "line", data: [{ xyPos: [.5, .7], length: .15, angle: Math.PI/6 }]},
			{ shape: "textBit", data: [{ xyPos: [.67, .77], text: "Cl" }]},
		]
	});
	
// the hydrogen can be reflected and have its opacity changed
var sketch9_3 = new Sketch ({
		id: "sketch9_3",
		drawShape:
		[
			{ shape: "line", data: [{ xyPos: [.5, .7], length: .15, angle: 5*Math.PI/6 }]},
			{ shape: "textBit", data: [{ xyPos: [.33, .77], text: "H" }]},
		]
	});

// molecule 2
var sketch9_4 = new Sketch ({
		id: "sketch9_4",
		drawShape:
		[
			{ shape: "line", data: [{ xyPos: [.1, .7], length: .2, angle: -Math.PI/2 }]},
			{ shape: "line", data: [{ xyPos: [.1, .5], length: .2, angle: -Math.PI/10 }]},
			{ shape: "line", data: [{ xyPos: [.29, .44], length: .2, angle: 3*Math.PI/10 }]},
			{ shape: "line", data: [{ xyPos: [.41, .6], length: .2, angle: 7*Math.PI/10 }]},
			{ shape: "line", data: [{ xyPos: [.29, .76], length: .2, angle: 11*Math.PI/10 }]},
			
		]
	});
	
// this part of molecule 2 moves separately
var sketch9_5 = new Sketch ({
		id: "sketch9_5",
		drawShape:
		[
			{ shape: "line", data: [{ xyPos: [.41, .6], length: .2, angle: 0 }]},
			{ shape: "line", data: [{ xyPos: [.425, .57], length: .17, angle: 0 }]},
			{ shape: "line", data: [{ xyPos: [.61, .6], length: .2, angle: -Math.PI/3 }]},
		]
	})
	
// the hydrogen can be reflected and have its opacity changed
var sketch9_6 = new Sketch ({
		id: "sketch9_6",
		drawShape:
		[
			{ shape: "line", data: [{ xyPos: [.61, .6], length: .15, angle: Math.PI/3 }]},
			{ shape: "textBit", data: [{ xyPos: [.72, .76], text: "H" }]}
		]
	});
	
// the label is a separate sketch because the entire molecule can move
// the labe should not move with it
var sketch9_7 = new Sketch ({
		id: "sketch9_7",
		drawShape:
		[
			{ shape: "textBit", data: [{ xyPos: [.05, .85], text: "b." }]},
		]
	});

// draw all the sketches
svg9.append(sketch9_1, {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, widthPercent: .5});
svg9.append(sketch9_2, {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, widthPercent: .5});
svg9.append(sketch9_3, {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, widthPercent: .5});
svg9.append(sketch9_4, {topPercentOffset: 0, leftPercentOffset: .5, heightPercent: 1, widthPercent: .5});
svg9.append(sketch9_5, {topPercentOffset: 0, leftPercentOffset: .5, heightPercent: 1, widthPercent: .5});
svg9.append(sketch9_6, {topPercentOffset: 0, leftPercentOffset: .5, heightPercent: 1, widthPercent: .5});
svg9.append(sketch9_7, {topPercentOffset: 0, leftPercentOffset: .5, heightPercent: 1, widthPercent: .5});

// hydrogens should be blue
sketch9_3.setColor("blue");
sketch9_6.setColor("blue");

// buttons should trigger events
var button9_1pressedEventId = 'b9_1' + '_Pressed';
var button9_2pressedEventId = 'b9_2' + '_Pressed';
var button9_3pressedEventId = 'b9_3' + '_Pressed';
eventManager.subscribe(button9_1pressedEventId, handleClick9_1);
eventManager.subscribe(button9_2pressedEventId, handleClick9_2);
eventManager.subscribe(button9_3pressedEventId, handleClick9_3);

// event to publish to make changes to button in another iframe (temp hack for test)
var b9_1_bricModifyEventId = 'b9_1' + '_bricModify';

// flag to keep track of the hydrogen state
var opaque9 = true;
function handleClick9_1 ()
{
	// if hydrogens are visible
	if (opaque9)
	{
		// hide them
		sketch9_3.setOpacity(0, 500, 0);
		sketch9_6.setOpacity(0, 500, 0);
		setTimeout(function ()
			{
				eventManager.publish(b9_1_bricModifyEventId, {text: "Show H"});
				opaque9 = false;
			}, 500);
	}
	// if hydrogens are not visible
	else
	{
		// reveal them
		sketch9_3.setOpacity(1, 500, 0);
		sketch9_6.setOpacity(1, 500, 0);
		setTimeout(function ()
			{
				eventManager.publish(b9_1_bricModifyEventId, {text: "Hide H"});
				opaque9 = true;
			}, 500);
	}
}
// reflect molecule parts
function handleClick9_2 ()
{
	sketch9_2.reflect(.5, null, 1000, 0);
	sketch9_3.reflect(.5, null, 1000, 0);
	sketch9_5.reflect(null, .6, 1000, 0);
	sketch9_6.reflect(null, .6, 1000, 0);
}
// reflect all of molecule 2
function handleClick9_3 ()
{
	sketch9_4.reflect(null, .6, 1000, 0);
	sketch9_5.reflect(null, .6, 1000, 0);
	sketch9_6.reflect(null, .6, 1000, 0);
}
	

eventManager.listenBroker();

	</script>
</body>
</html>
