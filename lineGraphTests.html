<!DOCTYPE html>
<html>
	<head>
	<title class="setTitle"></title>
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<meta content="eCourses Author, Title" name="description">   	
    <!-- Bootstrap -->
  
    <link href="css/bootstrap_plus.css" rel="stylesheet" media="screen">
	<link href="css/widgets.css" rel="stylesheet">
	<link href="css/learning-objective.css" rel="stylesheet">
	<link href="css/module-opener.css" rel="stylesheet">
	<!-- link href="css/toc.css" rel="stylesheet"-->
	<!-- link href="css/grey-thing.css" rel="stylesheet"-->
	<link href="css/eCourse-master.css" rel="stylesheet" media="screen">

	</head>
	<body>
	<div class="container-fluid">
		<div class="row-fluid">
			<div class="span6 leftCol">
                <h2 class="setTitle"></h2>
				<div id="widgetTarget0n"><p>0. Line Graph one line linear</p></div>
				<div id="widgetTarget1n"><p>1. Line graph several traces linear</p>
                </div>
				<div id="widgetTarget2n"><p>2. Scatter graph</p></div>
				<div id="widgetTarget3n">
                	<p>3. Lines and points several traces linear</p>
                </div>
                <div id="ordX">
                	<p>4. Ordinal x values are strings</p>
                </div>
			</div>
			<div class="span6 rightCol">
				<div id="widgetTarget50n"><p>5. Several traces log scale</p></div>
				<div id="widgetTarget60n"><p>6. Several traces Ordinal <span style="color: red">BUG: this graph doesn't use the full available width, it should.</span></p></div>
				<div id="widgetTarget70n"><p>7. Small multiples (several line graphs in container) <span style="color: red">BUG: the first axis shoves over too far leaving not enough remaining space to draw the graph.  Need to rethink sizing when it doesn't fit.</span></p></div>
				<div id="widgetTarget80n"><p>8. Lines with Legend</p></div>
			</div>
		</div>
	</div>
    
    
	<script src="js/jquery-latest.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery-ui-1.10.2.custom.js"></script>
	<script src="js/toc-structure.js"></script>
	<script src="js/eCourse-master.js"></script>
    <script src="js/eventmanager.js"></script>
	<script src="js/d3.v3.min.js"></script>

	<!--script src="js/goog.base.js"></script>
	<script src="js/widget-axes.js"></script-->

	<script src="js/widget-base.js"></script>
	<script src="js/widget-linegraph.js"></script>
    <script src="js/widget-legend.js"></script>
    <script src="js/widget-labelgroup.js"></script>

<script>

	var eventManager = new EventManager();

	var testData = [
			{ x:    0, y: 0 },
			{ x:    5, y: 5 },
			{ x: 1000, y: 1000 }
		];

	var ordinalData = [
			{ x: 3, y: "Energy 2" },
			{ x: 6, y: "Energy 2" }
		];

	var ordinalData2 = [
			{ x: 1, y: "Energy 1" },
			{ x: 4, y: "Energy 1" },
		];

	var lineData1 = [
			{ x:    1, y: 0.0011	},
			{ x:  150, y: 0.02		},
			{ x:  500, y: 0.2		},
			{ x: 1300, y: 0.36		},
			{ x: 1400, y: 0.34		},
			{ x: 1500, y: 0.425		},
			{ x: 1600, y: 0.545		},
			{ x: 1700, y: 0.61		},
			{ x: 1750, y: 0.7		},
			{ x: 1800, y: 0.9		},
			{ x: 1850, y: 1.128		},
			{ x: 1900, y: 1.55		},
			{ x: 1910, y: 1.75		},
			{ x: 1920, y: 1.86		},
			{ x: 1925, y: 2.0		},
			{ x: 1940, y: 2.3		},
			{ x: 1950, y: 2.529346	},
			{ x: 1960, y: 3.023358	},
			{ x: 1965, y: 3.33167	},
			{ x: 1970, y: 3.685777	},
			{ x: 1974, y: 4.00		},
			{ x: 1980, y: 4.437609	},
			{ x: 1985, y: 4.846247	},
			{ x: 1990, y: 5.290452	},
			{ x: 1996, y: 6.00		},
			{ x: 2000, y: 6.115367	},
			{ x: 2005, y: 6.512276	},
			{ x: 2010, y: 6.908688	}
		]; // array of line data

	var lineData2 = [
			{ x:  12,   y: -3.1 },
			{ x:  16.7, y: -2.02 },
			{ x:  19.8, y: -1.2 },
			{ x: 124.9, y: -0.36 },
			{ x: 156.0, y: -0.34 },
			{ x: 234,   y: 0.425 },
			{ x: 456.7, y: 0.545 },
			{ x: 555,   y: 0.61 },
			{ x: 666.6, y: 0.7 },
			{ x: 700,   y: 0.9 },
			{ x: 892.1, y: 1.128 },
			{ x: 899,   y: 1.55 },
			{ x: 910,   y: 1.75 },
			{ x: 920,   y: 1.86 }
		]; // array of line data

	var specData = [
			{ x:  280.0, y: 8.2000E-02 },
			{ x:  290.0, y: 5.6300E-01 },
			{ x:  300.0, y: 4.5794E-01 },
			{ x:  310.0, y: 5.3300E-01 },
			{ x:  320.0, y: 7.7500E-01 },
			{ x:  330.0, y: 1.1098E+00 },
			{ x:  340.0, y: 1.0544E+00 },
			{ x:  340.5, y: 1.0463E+00 },
			{ x:  341.0, y: 9.7100E-01 },
			{ x:  341.5, y: 9.5900E-01 },
			{ x:  350.0, y: 1.0122E+00 },
			{ x:  360.0, y: 1.0890E+00 },
			{ x:  370.0, y: 1.2934E+00 },
			{ x:  370.5, y: 1.1660E+00 },
			{ x:  380.0, y: 1.1520E+00 },
			{ x:  380.5, y: 1.2310E+00 },
			{ x:  390.0, y: 1.2519E+00 },
			{ x:  400.0, y: 1.6885E+00 },
			{ x:  420.0, y: 1.5990E+00 },
			{ x:  430.0, y: 1.2120E+00 },
			{ x:  450.0, y: 2.0690E+00 },
			{ x:  460.0, y: 1.9973E+00 },
			{ x:  470.0, y: 1.9390E+00 },
			{ x:  480.0, y: 2.0680E+00 },
			{ x:  490.0, y: 2.0320E+00 },
			{ x:  500.0, y: 1.9160E+00 },
			{ x:  510.0, y: 1.9100E+00 },
			{ x:  520.0, y: 1.8600E+00 },
			{ x:  530.0, y: 1.8920E+00 },
			{ x:  540.0, y: 1.8000E+00 },
			{ x:  550.0, y: 1.8630E+00 },
			{ x:  560.0, y: 1.7860E+00 },
			{ x:  570.0, y: 1.8280E+00 },
			{ x:  580.0, y: 1.8340E+00 },
			{ x:  590.0, y: 1.7218E+00 },
			{ x:  600.0, y: 1.7700E+00 },
			{ x:  630.0, y: 1.6650E+00 },
			{ x:  660.0, y: 1.5580E+00 },
			{ x:  690.0, y: 1.4790E+00 },
			{ x:  700.0, y: 1.4220E+00 },
			{ x:  730.0, y: 1.3357E+00 },
			{ x:  760.0, y: 1.2590E+00 },
			{ x:  780.0, y: 1.1930E+00 },
			{ x:  800.0, y: 1.1248E+00 },
			{ x:  830.0, y: 1.0563E+00 },
			{ x:  860.0, y: 1.0000E+00 },
			{ x:  890.0, y: 9.4236E-01 },
			{ x:  900.0, y: 9.1378E-01 },
			{ x:  925.0, y: 8.7642E-01 },
			{ x:  950.0, y: 8.2867E-01 },
			{ x:  975.0, y: 7.7348E-01 },
			{ x: 1000.0, y: 7.4255E-01 },
			{ x: 1025.0, y: 6.9918E-01 },
			{ x: 1050.0, y: 6.6117E-01 },
			{ x: 1150.0, y: 5.4623E-01 },
			{ x: 1175.0, y: 5.1852E-01 }
		];

	var lineData = [
			{x: 1900, y: 1.55 },
			{x: 1910, y: 1.75 },
			{x: 1920, y: 1.86 },
			{x: 1930, y: 2.07 },
			{x: 1940, y: 2.3 },
			{x: 1950, y: 2.529346 },
			{x: 1955, y: 2.763453 },
			{x: 1960, y: 3.023358 },
			{x: 1965, y: 3.33167 },
			{x: 1970, y: 3.685777 },
			{x: 1975, y: 4.061317 },
			{x: 1980, y: 4.437609 },
			{x: 1985, y: 4.846247 },
			{x: 1990, y: 5.290452 },
			{x: 1995, y: 5.713073 },
			{x: 2000, y: 6.115367 },
			{x: 2005, y: 6.512276 },
			{x: 2010, y: 6.908688 }
		]; // array of data - could be read from file

	var ordinalxData = [
			{x: "1900", y: 2000.55 },
			{x: "string value", y: 3056 },
			{x: "10-1-1980", y: 210 },
		]; // array of data - could be read from file

	projected = [];
	for ( i = 0; i < 10; i++) {
		projected[i] = { x: 2010 + i*5,
						 y: 6.908688*Math.exp(0.12*(.5*i)) };
	}

	nineB = [
			{ x: 1900, y: 9 },
			{ x: 2050, y: 9 }
		];



    //<div id="widgetTarget0"><p>0. Line Graph one line linear</p></div>
	var n = 0;			// test case index we're graphing
	var config = [];	// array of config objects for creating containers and line graph widgets
	var cntr = [];		// array of containers
	var lineGraph = []; // array of line graph widgets
	n = config.push({cntr: null, lg: null}) - 1;
	config[n].cntr = {
			node: d3.select("#widgetTarget0n"),
			maxWid: 400,
			maxHt: 300
		};

	config[n].lg = {
			id: "lg" + n,
			Data: [lineData1],
			type: "lines",
			xAxisFormat: { type: "linear",
						   ticks: 5,
						   orientation: "bottom",
						   label: "one line with markup <span class='math'>y=x<sup>2</sup></span>" },
			yAxisFormat: { type: "linear",
						   ticks: 5,
						   orientation: "right",
						   label: "Labels can have extended chars (&mu;m)" },
		};

	cntr[n] = new SVGContainer(config[n].cntr);
	lineGraph[n] = new LineGraph(config[n].lg);
	cntr[n].append(lineGraph[n], {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, widthPercent: 1});


//  <div id="widgetTarget1"><p>1. Line graph several traces linear</p></div>
	n = config.push({cntr: null, lg: null}) - 1;
	config[n].cntr = {
			node: d3.select("#widgetTarget1n"),
			maxWid: 400,
			maxHt: 300
		};

	config[n].lg = {
			id: "lg" + n,
			Data: [lineData1, lineData2],
			type: "lines",
			xAxisFormat: { type: "linear",
						   ticks: 5,
						   orientation: "bottom",
						   label: "an x axis on bottom" },
			yAxisFormat: { type: "linear",
						   ticks: 5,
						   orientation: "left",
						   label: "Population (Billions)" },
		};

	cntr[n] = new SVGContainer(config[n].cntr);
	lineGraph[n] = new LineGraph(config[n].lg);
	cntr[n].append(lineGraph[n], {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, widthPercent: 1});

    //  <div id="widgetTarget2"><p>2. Scatter graph</p></div>
	n = config.push({cntr: null, lg: null}) - 1;
	config[n].cntr = {
			node: d3.select("#widgetTarget2n"),
			maxWid: 400,
			maxHt: 300
		};

	config[n].lg = {
			id: "lg" + n,
			Data: [lineData1],
			type: "points",
			xAxisFormat: { type: "linear",
						   ticks: [1200, 1500, 1900, 2050],
						   orientation: "bottom",
						   label: "Year (explicit ticks)" },
			yAxisFormat: { type: "linear",
						   ticks: 5,
						   orientation: "left",
						   label: "Population (Billions)" },
		};

	cntr[n] = new SVGContainer(config[n].cntr);
	lineGraph[n] = new LineGraph(config[n].lg);
	cntr[n].append(lineGraph[n], {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, widthPercent: 1});

//  <div id="widgetTarget3"><p>3. Lines and points several traces linear</p></div>
	n = config.push({cntr: null, lg: null}) - 1;
	config[n].cntr = {
			node: d3.select("#widgetTarget3n"),
			maxWid: 400,
			maxHt: 200
		};

	config[n].lg = {
			id: "lg" + n,
			Data: [lineData2, specData],
			type: "lines+points",
			xAxisFormat: { type: "linear",
						   ticks: [400, 600, 800, 1000],
						   orientation: "top",
						   label: "x axis on the top" },
			yAxisFormat: { type: "linear",
						   ticks: 5,
						   orientation: "right",
						   label: "a y axis on the right" },
		};

	cntr[n] = new SVGContainer(config[n].cntr);
	lineGraph[n] = new LineGraph(config[n].lg);
	cntr[n].append(lineGraph[n], {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, widthPercent: 1});


    //  <div id="widgetTarget50"><p>4. Several traces log scale</p></div>
	n = config.push({cntr: null, lg: null}) - 1;
	config[n].cntr = {
			node: d3.select("#widgetTarget50n"),
			maxWid: 400,
			maxHt: 300
		};

	config[n].lg = {
			id: "lg" + n,
			Data: [specData],
			type: "lines",
			xAxisFormat: { type: "log",
						   ticks: 5,
						   orientation: "bottom",
						   label: "log scale" },
			yAxisFormat: { type: "linear",
						   ticks: 5,
						   orientation: "left",
						   label: "linear scale" },
		};

	cntr[n] = new SVGContainer(config[n].cntr);
	lineGraph[n] = new LineGraph(config[n].lg);
	cntr[n].append(lineGraph[n], {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, widthPercent: 1});

  //  <div id="ordX"><p>4. Ordinal x values are strings</p></div>
	var ordXSVG = new SVGContainer( {
			node: d3.select("#ordX"),
			maxWid: 400,
			maxHt: 400
		});

	var ordXGraph = new LineGraph({
			Data: [ordinalxData],
			type: "lines+points",
			xAxisFormat: { type: "ordinal",
						   orientation: "bottom",
						   label: "ordinal scale" },
			yAxisFormat: { type: "linear",
						   orientation: "left",
						   ticks: 2,
						   label: "linear scale" },
		});

	ordXSVG.append(ordXGraph);

    //  <div id="widgetTarget60"><p>5. traces Ordinal</p></div>
	n = config.push({cntr: null, lg: null}) - 1;
	config[n].cntr = {
			node: d3.select("#widgetTarget60n"),
			maxWid: 400,
			maxHt: 400
		};

	config[n].lg = {
			id: "lg" + n,
			Data: [ordinalData, ordinalData2],
			type: "lines",
			xAxisFormat: { type: "linear",
						   ticks: [0, 10],
						   orientation: "bottom",
						   label: "linear scale" },
			yAxisFormat: { type: "ordinal",
						   orientation: "left",
						   label: "ordinal scale" },
		};

	cntr[n] = new SVGContainer(config[n].cntr);
	lineGraph[n] = new LineGraph(config[n].lg);
	cntr[n].append(lineGraph[n], {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, widthPercent: 1});


    //  <div id="widgetTarget70"><p>6. Small multiples (several line graphs in container)</p></div>
	n = config.push({cntr: null, lg: null}) - 1;
	config[n].cntr = {
			node: d3.select("#widgetTarget70n"),
			maxWid: 500,
			maxHt:200
		};

	config[n].lg = {
			id: "lg" + n,
			Data: [testData],
			type: "lines",
			xAxisFormat: { type: "linear",
						   ticks: 3,
						   orientation: "bottom",
						   label: "x vals" },
			yAxisFormat: { type: "linear",
						   ticks: 3,
						   orientation: "left",
						   label: "vertical" },
		};

	config[n].lg2 = {
			id: "lg2_" + n,
			Data: [lineData1],
			type: "lines",
			xAxisFormat: { type: "linear",
						   ticks: 3,
						   orientation: "bottom",
						   label: "x vals" },
			yAxisFormat: { type: "linear",
						   ticks: 3,
						   orientation: "left",
						   label: "vertical" },
		};

	config[n].lg3 = {
			id: "lg3_" + n,
			Data: [specData],
			type: "lines",
			xAxisFormat: { type: "linear",
						   ticks: 3,
						   orientation: "bottom",
						   label: "x vals" },
			yAxisFormat: { type: "linear",
						   ticks: 3,
						   orientation: "left",
						   label: "vertical" },
		};

	cntr[n] = new SVGContainer(config[n].cntr);
	lineGraph[n] = new LineGraph(config[n].lg);
	cntr[n].append(lineGraph[n], {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, widthPercent: 1/3});

	lineGraph2 = new LineGraph(config[n].lg2);
	cntr[n].append(lineGraph2, {topPercentOffset: 0, leftPercentOffset: 1/3, heightPercent: 1, widthPercent: 1/3});

	lineGraph3 = new LineGraph(config[n].lg3);
	cntr[n].append(lineGraph3, {topPercentOffset: 0, leftPercentOffset: 2/3, heightPercent: 1, widthPercent: 1/3});



    //  <div id="widgetTarget80"><p>80n. Lines with Legend</p></div>
	n = config.push({cntr: null, lg: null}) - 1;
	config[n].cntr = {
			node: d3.select("#widgetTarget80n"),
			maxWid: 500,
			maxHt: 400
		};

	config[n].lg = {
			id: "lg" + n,
			Data: [lineData, projected, nineB],
			type: "lines",
			xAxisFormat: { type: "linear",
						   ticks: [1900, 1950, 1990, 2010, 2030, 2050],
						   orientation: "bottom",
						   label: "Year" },
			yAxisFormat: { type: "linear",
						   ticks: 8,
						   orientation: "left",
						   label: "Human Population (Billions)" },
		};

	var lblGrpConfig80 = {
			id: "lbls80",
			type: "numbered",
			labels: 
			[
				{ content: "historical data",	xyPos: [1960, 3], width: 100},
				{ content: "predicted",	xyPos: [2011, 7],	width: 100	},
				{ content: "threshold" ,	xyPos: [1980, 9],	width: 100	},
			]
		};
	// create a label group that emits events
	var labelGroup80 = new LabelGroup(lblGrpConfig80, eventManager);

	cntr[n] = new SVGContainer(config[n].cntr);
	lineGraph[n] = new LineGraph(config[n].lg,eventManager);
	
	var legLines = new Legend({
		xPos: "left", yPos: "top",
		labels: [{ content: "historical data long discription",	},
				{ content: "predicted",	},
				{ content: "threshold" ,}],
		type: "line"
	},eventManager);
	
	// draw the lineGraph in the container
	cntr[n].append(lineGraph[n], {topPercentOffset: 0, leftPercentOffset: 0, heightPercent: 1, 		
	widthPercent: 1});
	
	// draw the legend and the labels on the line graph
	lineGraph[n].append([legLines, labelGroup80]);

	eventManager.subscribe(labelGroup80.selectedEventId,
						   handleSelectionChanged);
	eventManager.subscribe(legLines.selectedEventId,
						   handleSelectionChanged);
	eventManager.subscribe(lineGraph[n].selectedEventId,
						   handleSelectionChanged);
						   
	handleSelectionChanged({selectKey: "0"});
/************************************************************************
* handleSelectionChanged                                            *//**
*
* handleInputValueChanged is called from the event handler for one of
* the input widgets when the user changes its value. It updates the
* given matching input widget's value to match the new value and then
* updates the bar chart.
*
* @param eventDetails			These are the keyed values returned by 
*								the event, in this case, a selection
*								(click).
*************************************************************************/
	function handleSelectionChanged(eventDetails)
	{
		//Handler needs to get written into each page, 
		//each widget will have it's own way of responding  
		//since these are all highlight events, they have the 
		//lite method name
		
		labelGroup80.lite(eventDetails.selectKey);
		lineGraph[n].lite(eventDetails.selectKey);
		legLines.lite(eventDetails.selectKey);
		
	}

</script>
</body>
</html>
